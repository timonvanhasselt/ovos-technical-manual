<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><link rel="canonical" href="https://openvoiceos.github.io/ovos-technical-manual/prompts/" />
      <link rel="shortcut icon" href="../img/favicon.ico" />
    <title>Prompts - OVOS Technical Manual</title>
    <link rel="stylesheet" href="../css/theme.css" />
    <link rel="stylesheet" href="../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
        <link href="../css/extra.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "Prompts";
        var mkdocs_page_input_path = "prompts.md";
        var mkdocs_page_url = "/ovos-technical-manual/prompts/";
      </script>
    
    <!--[if lt IE 9]>
      <script src="../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href=".." class="icon icon-home"> OVOS Technical Manual
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption"><span class="caption-text">Home</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="..">Introduction</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../community/">Community</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../versioning/">Versioning</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../license/">License</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../timeline/">Timeline</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Architecture</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../bus_service/">Bus</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../speech_service/">Listener</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../core/">Core</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../audio_service/">Audio</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../gui_service/">GUI</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../OCP/">Media</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../config/">Configuration</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../backend/">Backend</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Self Hosting</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../stt_server/">STT Server</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tts_server/">TTS Server</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../persona_server/">Persona Server</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../translate_server/">Translate Server</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../personal_backend/">Personal Backend</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Plugins</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../OPM/">Plugin Manager</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../mic_plugins/">Microphone</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../vad_plugins/">Voice Activity Detection</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../ww_plugins/">Wake Word</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../stt_plugins/">Speech To Text</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tts_plugins/">Text To Speech</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../g2p_plugins/">Grapheme to Phoneme</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../transformer_plugins/">Transformers</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../lang_plugins/">Language Detection/Translation</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../solvers/">Question Solvers</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../nlp_plugins/">NLP Plugins</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../PHAL/">Platform/Hardware Abstraction Layer</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../ocp_plugins/">OCP Stream Extractors</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../media_plugins/">Media Playback</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Skills</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../guidelines/">Design Guidelines</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../skill_structure/">Anatomy</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../statements/">Dialog</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../intents/">Intents</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../user_res_files/">Customization</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../skills_bus/">Bus Interaction</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../skill_filesystem/">Filesystem</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../skill_settings/">Skill Settings</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../skill_api/">Skill API</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../runtime/">Runtime Requirements</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../skill_json/">Skill Json</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../skill_tests/">Skill Tests</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../dev/">F.A.Q.</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Continuous Conversation</span></p>
              <ul class="current">
                  <li class="toctree-l1 current"><a class="reference internal current" href="./">Prompts</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#open-ended-questions">Open Ended Questions</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#request-extra-information">Request Extra Information</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#optional-arguments">Optional Arguments</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#yes-no-questions">Yes / No Questions</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#providing-a-list-of-options">Providing a list of options</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#optional-arguments_1">Optional arguments</a>
    </li>
        </ul>
    </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../context/">Follow up Questions</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../converse/">Converse</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../layers/">Intent Layers</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../session_skills/">Session Aware Skills</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Voice Apps</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../voice_apps/">Standalone Apps</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../qt_apps/">QT Voice Apps</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Fallback</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../fallbacks/">Fallback Skills</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Common Query</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../common_query/">Common Query Skills</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Auto Translation</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../universal_skills/">Universal Skills</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Media</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../OCP_skills/">Media Skills</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../OCP_pipeline/">OCP Pipeline</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">GUI</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../homescreen/">Homescreen</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../gui_protocol/">Protocol</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../shell/">Shell</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../qt5/">QT5 mycroft-gui</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">MessageBus APIs</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../skill_gui/">GUI Interface</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../mk1_api/">Enclosure Api</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Technologies</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../eggscript/">Eggscript</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../bus_client/">Messagebus Client</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../mk1_utils/">Mark1 Utils</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../backend_client/">Backend Client</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../jurebes/">Jurebes</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../padacioso/">Padacioso</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../ovos_bigscreen/">Plasma Bigscreen</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="..">OVOS Technical Manual</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href=".." class="icon icon-home" aria-label="Docs"></a></li>
          <li class="breadcrumb-item">Continuous Conversation</li>
      <li class="breadcrumb-item active">Prompts</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="prompts">Prompts</h1>
<p>Here we look at how to implement the most common types of prompts. For more information on conversation design see
the <a href="https://mycroft-ai.gitbook.io/docs/skill-development/voice-user-interface-design-guidelines/interactions-and-guidelines/statements-and-prompts">Voice User Interface Design Guidelines</a>.</p>
<h2 id="open-ended-questions">Open Ended Questions</h2>
<p>Sometimes after a Skill finishes speaking, we want to activate the microphone and let the utterance be handled as usual</p>
<p>It is possible to speak some dialog, and activate the listener, directing the response back to the standard intent parsing engine. We
may do this to let the user trigger another Skill, or because we want to make use of our own intents to handle the
response.</p>
<p>To do this, we use the <code>expect_response</code> parameter of <code>self.speak</code> and  <code>self.speak_dialog</code> methods expose a keyword argument to trigger listening once TTS has finished playback</p>
<pre><code class="language-python">from ovos_workshop.skills import OVOSSkill
from ovos_workshop.decorators import intent_handler


class AskMeSkill(OVOSSkill):
    @intent_handler('ask_me_something.intent')
    def handle_set_favorite(self):
        question = random.choice(self.question_list)
        self.speak(question, expect_response=True)
</code></pre>
<h2 id="request-extra-information">Request Extra Information</h2>
<p>Any Skill can request extra information from the user before continuing - making a statement or asking a question before the microphone is
activated to record the User's response.</p>
<p>The base implementation of this is the <code>get_response()</code> method</p>
<p>To see it in action, let's create a simple Skill that asks the User what their favorite flavor of ice cream is.</p>
<pre><code class="language-python">from ovos_workshop.skills import OVOSSkill
from ovos_workshop.decorators import intent_handler


class IceCreamSkill(OVOSSkill):
    @intent_handler('set.favorite.intent')
    def handle_set_favorite(self):
        favorite_flavor = self.get_response('what.is.your.favorite.flavor')
        self.speak_dialog('confirm.favorite.flavor', {'flavor': favorite_flavor})
</code></pre>
<p>In this Skill we have used <code>get_response()</code> and passed it the name of our dialog
file <code>'what.is.your.favorite.flavor.dialog'</code>. This is the simplest form of this method. It will speak dialog from the
given file, then activate the microphone for 3-10 seconds allowing the User to respond. The transcript of their response
will then be assigned to our variable <code>favorite_flavor</code>. To confirm that we have heard the User correctly we then speak
a confirmation dialog passing the value of <code>favorite_flavor</code> to be spoken as part of that dialog.</p>
<h3 id="optional-arguments">Optional Arguments</h3>
<p>The <code>get_response()</code> method also takes the following optional arguments:</p>
<ul>
<li><code>data</code> (dict) - used to populate the dialog file, just like <code>speak_dialog()</code></li>
<li><code>validator</code> (function) - returns a boolean to define whether the response meets some criteria for success</li>
<li><code>on_fail</code> (function) - returns a string that will be spoken if the validator returns False</li>
<li><code>num_retries</code> (int) - number of times the system should repeat the question to get a successful result</li>
</ul>
<h2 id="yes-no-questions">Yes / No Questions</h2>
<p><code>ask_yesno()</code> checks if the response contains "yes" or "no" like phrases.</p>
<p>A longer phrase containing the required vocab is considered successful e.g. both "yes" and "yeah that would be great
thanks" would be considered a successful "yes".</p>
<p>If "yes" or "no" responses are detected, then the method will return the string "yes" or "no". If the response does not
contain "yes" or "no" vocabulary then the entire utterance will be returned. </p>
<p>If no speech was detected indicating the User did not respond, or said something unexpected, then the method will return <code>None</code>.</p>
<p><code>None</code> indicates an invalid answer, this tells the skill it should handle the error, such as by asking the question again</p>
<p>Let's add a new intent to our <code>IceCreamSkill</code> to see how this works.</p>
<pre><code class="language-python">from ovos_workshop.skills import OVOSSkill
from ovos_workshop.decorators import intent_handler


class IceCreamSkill(OVOSSkill):
    @intent_handler('do.you.like.intent')
    def handle_do_you_like(self):
        likes_ice_cream = self.ask_yesno('do.you.like.ice.cream')
        if likes_ice_cream == 'yes':
            self.speak_dialog('does.like')
        elif likes_ice_cream == 'no':
            self.speak_dialog('does.not.like')
        else:
            self.speak_dialog('could.not.understand')
</code></pre>
<p>In this example we have asked the User if they like ice cream. We then speak different dialog whether they respond yes
or no. We also speak some error dialog if neither yes nor no are returned.</p>
<p>A dedicated parser for each language is provided by <a href="https://github.com/OpenVoiceOS/ovos-lingua-franca/blob/dev/lingua_franca/parse.py#L121">ovos-lingua-franca</a>,
ensuring we can understand nuances such as double negation</p>
<p>Some example sentences that would be considered either "yes" or "no". </p>
<table>
<thead>
<tr>
<th>Test Utterance</th>
<th>Expected Result</th>
</tr>
</thead>
<tbody>
<tr>
<td>"beans"</td>
<td>None</td>
</tr>
<tr>
<td>"yes"</td>
<td>"yes"</td>
</tr>
<tr>
<td>"no"</td>
<td>"no"</td>
</tr>
<tr>
<td>"don't think so"</td>
<td>"no"</td>
</tr>
<tr>
<td>"i think not"</td>
<td>"no"</td>
</tr>
<tr>
<td>"that's affirmative"</td>
<td>"yes"</td>
</tr>
<tr>
<td>"no, but actually, yes"</td>
<td>"yes"</td>
</tr>
<tr>
<td>"yes, but actually, no"</td>
<td>"no"</td>
</tr>
<tr>
<td>"yes, yes, yes, but actually, no"</td>
<td>"no"</td>
</tr>
<tr>
<td>"please"</td>
<td>"yes"</td>
</tr>
<tr>
<td>"please don't"</td>
<td>"no"</td>
</tr>
<tr>
<td>"no! please! I beg you"</td>
<td>"no"</td>
</tr>
<tr>
<td>"yes, i don't want it for sure"</td>
<td>"no"</td>
</tr>
<tr>
<td>"please! I beg you"</td>
<td>"yes"</td>
</tr>
<tr>
<td>"i want it for sure"</td>
<td>"yes"</td>
</tr>
<tr>
<td>"obviously"</td>
<td>"yes"</td>
</tr>
<tr>
<td>"indeed"</td>
<td>"yes"</td>
</tr>
<tr>
<td>"no, I obviously hate it"</td>
<td>"no"</td>
</tr>
<tr>
<td>"that's certainly undesirable"</td>
<td>"no"</td>
</tr>
<tr>
<td>"yes, it's a lie"</td>
<td>"yes"</td>
</tr>
<tr>
<td>"no, it's a lie"</td>
<td>"no"</td>
</tr>
<tr>
<td>"he is lying"</td>
<td>"no"</td>
</tr>
<tr>
<td>"correct, he is lying"</td>
<td>"yes"</td>
</tr>
<tr>
<td>"it's a lie"</td>
<td>"no"</td>
</tr>
<tr>
<td>"you are mistaken"</td>
<td>"no"</td>
</tr>
<tr>
<td>"that's a mistake"</td>
<td>"no"</td>
</tr>
<tr>
<td>"wrong answer"</td>
<td>"no"</td>
</tr>
<tr>
<td>"it's not a lie"</td>
<td>"yes"</td>
</tr>
<tr>
<td>"he is not lying"</td>
<td>"yes"</td>
</tr>
<tr>
<td>"you are not mistaken"</td>
<td>"yes"</td>
</tr>
<tr>
<td>"tou are not wrong"</td>
<td>"yes"</td>
</tr>
</tbody>
</table>
<h2 id="providing-a-list-of-options">Providing a list of options</h2>
<p><code>ask_selection()</code> provides a list of options to the User for them to select from. The User can respond with either the
name of one of these options or select with a numbered ordinal eg "the third".</p>
<p>This method automatically manages fuzzy matching the users response against the list of options provided. </p>
<p>It also understands "numeric" responses, such as "the first option", "the third one", "option 4", "the last one"</p>
<p>Let's jump back into our <code>IceCreamSkill</code> to give the User a list of options to choose from.</p>
<pre><code class="language-python">from ovos_workshop.skills import OVOSSkill
from ovos_workshop.decorators import intent_handler


class IceCreamSkill(OVOSSkill):
    def initialize(self):
        self.flavors = ['vanilla', 'chocolate', 'mint']

    @intent_handler('request.icecream.intent')
    def handle_request_icecream(self):
        self.speak_dialog('welcome')
        selection = self.ask_selection(self.flavors, 'what.flavor')
        self.speak_dialog('coming.right.up', {'flavor': selection})
</code></pre>
<p>In this example we first speak some <code>welcome.dialog</code>. The list of flavors is then spoken, followed by
the <code>what.flavor.dialog</code>. Finally, we confirm the Users selection by speaking <code>coming.right.up.dialog</code></p>
<h3 id="optional-arguments_1">Optional arguments</h3>
<p>There are two optional arguments for this method.</p>
<p><code>min_conf</code> (float) defines the minimum confidence level for fuzzy matching the Users response against the list of
options. <code>numeric</code> (bool) if set to True will speak the options as a numbered list eg "One, vanilla. Two, chocolate. Or
three, mint"</p>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../dev/" class="btn btn-neutral float-left" title="F.A.Q."><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="../context/" class="btn btn-neutral float-right" title="Follow up Questions">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
      <span><a href="../dev/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../context/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script src="../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "..";</script>
    <script src="../js/theme_extra.js"></script>
    <script src="../js/theme.js"></script>
      <script src="../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
