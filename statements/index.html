<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><link rel="canonical" href="https://openvoiceos.github.io/ovos-technical-manual/statements/" />
      <link rel="shortcut icon" href="../img/favicon.ico" />
    <title>Dialog - OVOS Technical Manual</title>
    <link rel="stylesheet" href="../css/theme.css" />
    <link rel="stylesheet" href="../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
        <link href="../css/extra.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "Dialog";
        var mkdocs_page_input_path = "statements.md";
        var mkdocs_page_url = "/ovos-technical-manual/statements/";
      </script>
    
    <!--[if lt IE 9]>
      <script src="../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href=".." class="icon icon-home"> OVOS Technical Manual
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption"><span class="caption-text">Home</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="..">Introduction</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../community/">Community</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../versioning/">Versioning</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../license/">License</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../timeline/">Timeline</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Architecture</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../bus_service/">Bus</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../speech_service/">Listener</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../core/">Core</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../audio_service/">Audio</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../gui_service/">GUI</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../OCP/">Media</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../config/">Configuration</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../backend/">Backend</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Self Hosting</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../stt_server/">STT Server</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tts_server/">TTS Server</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../persona_server/">Persona Server</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../translate_server/">Translate Server</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../personal_backend/">Personal Backend</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Plugins</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../OPM/">Plugin Manager</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../mic_plugins/">Microphone</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../vad_plugins/">Voice Activity Detection</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../ww_plugins/">Wake Word</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../stt_plugins/">Speech To Text</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tts_plugins/">Text To Speech</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../g2p_plugins/">Grapheme to Phoneme</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../transformer_plugins/">Transformers</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../lang_plugins/">Language Detection/Translation</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../solvers/">Question Solvers</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../nlp_plugins/">NLP Plugins</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../PHAL/">Platform/Hardware Abstraction Layer</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../ocp_plugins/">OCP Stream Extractors</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../media_plugins/">Media Playback</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Skills</span></p>
              <ul class="current">
                  <li class="toctree-l1"><a class="reference internal" href="../guidelines/">Design Guidelines</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../skill_structure/">Anatomy</a>
                  </li>
                  <li class="toctree-l1 current"><a class="reference internal current" href="./">Dialog</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#speaking-a-statement">Speaking a statement</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#multilingualism">Multilingualism</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#the-tomato-skill-revisited">The Tomato Skill Revisited</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#simple-statement">Simple statement</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#file-locations">File locations</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#statements-with-variables">Statements with variables</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#waiting-for-speech">Waiting for speech</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#wait-parameter">Wait Parameter</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#using-translatable-resources">Using translatable resources</a>
    </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../intents/">Intents</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../user_res_files/">Customization</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../skills_bus/">Bus Interaction</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../skill_filesystem/">Filesystem</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../skill_settings/">Skill Settings</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../skill_api/">Skill API</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../runtime/">Runtime Requirements</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../skill_json/">Skill Json</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../skill_tests/">Skill Tests</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../dev/">F.A.Q.</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Continuous Conversation</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../prompts/">Prompts</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../context/">Follow up Questions</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../converse/">Converse</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../layers/">Intent Layers</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../session_skills/">Session Aware Skills</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Voice Apps</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../voice_apps/">Standalone Apps</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../qt_apps/">QT Voice Apps</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Fallback</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../fallbacks/">Fallback Skills</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Common Query</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../common_query/">Common Query Skills</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Auto Translation</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../universal_skills/">Universal Skills</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Media</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../OCP_skills/">Media Skills</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../OCP_pipeline/">OCP Pipeline</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">GUI</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../homescreen/">Homescreen</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../gui_protocol/">Protocol</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../shell/">Shell</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../qt5/">QT5 mycroft-gui</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">MessageBus APIs</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../skill_gui/">GUI Interface</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../mk1_api/">Enclosure Api</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Technologies</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../eggscript/">Eggscript</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../bus_client/">Messagebus Client</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../mk1_utils/">Mark1 Utils</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../backend_client/">Backend Client</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../jurebes/">Jurebes</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../padacioso/">Padacioso</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../ovos_bigscreen/">Plasma Bigscreen</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="..">OVOS Technical Manual</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href=".." class="icon icon-home" aria-label="Docs"></a></li>
          <li class="breadcrumb-item">Skills</li>
      <li class="breadcrumb-item active">Dialog</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="statements">Statements</h1>
<h2 id="speaking-a-statement">Speaking a statement</h2>
<p>One of OVOS's most important core capabilities is to convert text to speech, that is, to speak a statement.</p>
<p>Within a Skill's Intent handler, you may pass a string of text to OVOS and OVOS will speak it.  For example: <code>self.speak('this is my statement')</code>.  That's cool and fun to experiment with, but passing strings of text to Mycroft doesn't help to make Mycroft a multilingual product. Rather than hard-coded strings of text, OVOS has a design pattern for multilingualism.</p>
<h3 id="multilingualism">Multilingualism</h3>
<p>To support multilingualism, the text that OVOS speaks must come from a file. That file is called a dialog file. The dialog file contains statements (lines of text) that a listener in a particular language would consider to be equivalent.  For instance, in USA English, the statements "I am okay" and "I am fine" are equivalent, and both of these statements might appear in a dialog file used for responding to the USA English question: "How are you?".</p>
<p>By convention, the dialog filename is formed by <em>dot connected</em> <em>words</em> and must end with ".dialog".  The dialog filename should be descriptive of the contents as a whole.  Sometimes, the filename describes the question being answered, and other times, the filename describes the answer itself.  For the example above, the dialog filename might be: <strong>how.are.you.dialog</strong> or <strong>i.am.fine.dialog</strong>.</p>
<p>Multilingualism is accomplished by translating the dialog files into other languages, and storing them in their own directory named for the country and language. The filenames remain the same.  Using the same filenames in separate language dependent directories allows the Skills to be language agnostic; no hard-coded text strings.  Adjust the language setting for your Device **** and OVOS uses the corresponding set of dialog files.  If the desired file does not exist in the directory for that language, Mycroft will use the file from the USA English directory.</p>
<p>As an example of the concept, the contents of <strong>how.are.you.dialog</strong> in the directory for the French language in France (fr-fr) might include the statement: "Je vais bien".</p>
<h3 id="the-tomato-skill-revisited">The Tomato Skill Revisited</h3>
<p>To demonstrate the multilingualism design pattern, we examine the usage of the <code>speak_dialog()</code> method in the <a href="intents/padatious-intents.md">Tomato Skill</a> . &#x20;</p>
<p>The Tomato Skill has two Intents: one demonstrates simple, straightforward statements, and the other demonstrates the use of variables within a statement.</p>
<h3 id="simple-statement">Simple statement</h3>
<p>The first Intent within the Tomato Skill, <strong>what.is.a.tomato.intent</strong>, handles inquiries about tomatoes, and the dialog file, <strong>tomato.description.dialog</strong>, provides the statements for OVOS to speak in reply to that inquiry.</p>
<p>Sample contents of the Intent and dialog files:</p>
<p><code>what.is.a.tomato.intent</code></p>
<pre><code>what is a tomato
what would you say a tomato is
describe a tomato
what defines a tomato
</code></pre>
<p><code>tomato.description.dialog</code></p>
<pre><code>The tomato is a fruit of the nightshade family
A tomato is an edible berry of the plant Solanum lycopersicum
A tomato is a fruit but nutrionists consider it a vegetable
</code></pre>
<p>Observe the statements in the tomato.description.dialog file. They are all acceptable answers to the question: "What is a tomato?"  Providing more than one statement in a dialog file is one way to make OVOS to seem less robotic, more natural. 
OVOS will randomly select one of the statements.</p>
<p>The Tomato Skill code snippet:</p>
<pre><code class="language-python">@intent_handler('what.is.a.tomato.intent')
def handle_what_is(self, message):
    &quot;&quot;&quot;Speaks a statement from the dialog file.&quot;&quot;&quot;
    self.speak_dialog('tomato.description')
</code></pre>
<p>With the Tomato Skill installed, if the User utters **** "Hey Mycroft, what is a tomato?", the Intent handler method <code>handle_what_is()</code> will be called.</p>
<p>Inside <code>handle_what_is()</code>, we find: <code>self.speak_dialog('tomato.description')</code> &#x20;</p>
<p>As you can probably guess, the parameter <code>'tomato.description'</code> is the dialog filename without the ".dialog" extension. Calling this method opens the dialog file, selects one of the statements, and converts that text to speech. OVOS will speak a statement from the dialog file.  In this example, OVOS might say "The tomato is a fruit of the nightshade family". &#x20;</p>
<p>Remember, OVOS has a language setting that determines from which directory to find the dialog file.</p>
<h4 id="file-locations">File locations</h4>
<p>The <a href="../skill-structure/">Skill Structure</a> section describes where to place the Intent file and dialog file.  Basically, there are two choices:</p>
<ol>
<li>Put both files in <code>locale/en-us</code></li>
<li>Put the dialog file in <code>dialog/en-us</code> , and put the Intent file in <code>vocab/en-us</code></li>
</ol>
<h3 id="statements-with-variables">Statements with variables</h3>
<p>The second Padatious Intent, <strong>do.you.like.intent</strong>, demonstrates the use of variables in the Intent file and in one of the dialog files:</p>
<p><code>do.you.like.intent</code></p>
<pre><code>do you like tomatoes
do you like {type} tomatoes
</code></pre>
<p><code>like.tomato.type.dialog</code></p>
<pre><code>I do like {type} tomatoes
{type} tomatoes are my favorite
</code></pre>
<p><code>like.tomato.generic.dialog</code></p>
<pre><code>I do like tomatoes
tomatoes are my favorite
</code></pre>
<p>Compare these two dialog files. The <strong>like.tomato.generic.dialog</strong> file contains only simple statements. The statements in the <strong>like.tomato.type.dialog</strong> file include a variable named <code>type</code>.  The variable is a placeholder in the statement specifying where text may be inserted. The <code>speak_dialog()</code> method accepts a dictionary as an optional parameter. If that dictionary contains an entry for a variable named in the statement, then the value from the dictionary will be inserted at the placeholder's location.</p>
<p>Dialog file variables are formed by surrounding the variable's name with curly braces. 
In OVOS parlance, curly braces are known as a <em>mustache</em>.</p>
<p>For multi-line dialog files, be sure to include the <strong>same</strong> variable on <strong>all</strong> lines.</p>
<p>The Tomato Skill code snippet:</p>
<pre><code class="language-python">    @intent_handler('do.you.like.intent')
    def handle_do_you_like(self, message):
        tomato_type = message.data.get('type')
        if tomato_type is not None:
            self.speak_dialog('like.tomato.type',
                              {'type': tomato_type})
        else:
            self.speak_dialog('like.tomato.generic')
</code></pre>
<p>When the User utters "Hey Mycroft, do you like RED tomatoes?", the second of the two Intent lines "do you like {type} tomatoes" is recognized by Mycroft, and the value 'RED' is returned in the message dictionary assigned to the 'type' entry when <code>handle_do_you_like()</code> is called. &#x20;</p>
<p>The line <code>tomato_type = message.data.get('type')</code> extracts the value from the dictionary for the entry 'type'.  In this case,  the variable <code>tomato_type</code> will receive the value 'RED', and <code>speak_dialog()</code>will be called with the 'like.tomato.type' dialog file, and a dictionary with 'RED' assigned to 'type'.   The statement "I do like {type} tomatoes" might be randomly selected, and after insertion of the value 'RED' for the placeholder variable {type}, OVOS would say: "I do like RED tomatoes".</p>
<p>Should the User utter "Hey Mycroft, do you like tomatoes?", the first line in the Intent file "do you like tomatoes" is recognized. There is no variable in this line, and when <code>handle_do_you_like()</code> is called, the dictionary in the message is empty. This means <code>tomato_type</code> is <code>None</code>,<code>speak_dialog('like.tomato.generic')</code> would be called, and Mycroft might reply with "Yes, I do like tomatoes".</p>
<h2 id="waiting-for-speech">Waiting for speech</h2>
<p>By default, the <code>speak_dialog()</code> method is non-blocking. That is any code following the call to <code>speak_dialog()</code> will execute whilst OVOS is talking. This is useful to allow your Skill to perform actions while it is speaking.&#x20;</p>
<p>Rather than telling the User that we are fetching some data, then going out to fetch it, we can do the two things simultaneously providing a better experience.&#x20;</p>
<p>However, there are times when we need to wait until the statement has been spoken before doing something else. We have two options for this.</p>
<h3 id="wait-parameter">Wait Parameter</h3>
<p>We can pass a <code>wait=True</code> parameter to our <code>speak_dialog()</code> method. This makes the method blocking and no other code will execute until the statement has been spoken.</p>
<pre><code class="language-python">@intent_handler('what.is.a.tomato.intent')
def handle_what_is(self, message):
    &quot;&quot;&quot;Speaks a statement from the dialog file.
       Waits (i.e. blocks) within speak_dialog() until
       the speaking has completed. &quot;&quot;&quot;
    self.speak_dialog('tomato.description', wait=True)
    self.log.info(&quot;I waited for you&quot;)
</code></pre>
<h2 id="using-translatable-resources">Using translatable resources</h2>
<p>There may be a situation where the dialog file and the <code>speak_dialog()</code> method do not give the Skill enough flexibility. For instance, there may be a need to manipulate the statement from the dialog file before having it spoken by OVOS.</p>
<p>The OVOSSkill class provides four multilingual methods to address these needs.  Each method uses a file, and multilingualism is accomplished using the country/language directory system.</p>
<p>The <code>translate()</code> method returns a random string from a ".dialog" file (modified by a data dictionary). &#x20;</p>
<p>The <code>translate_list()</code> method returns a list of strings from a ".list" file (each modified by the data dictionary). Same as translate_template() just with a different file extension.</p>
<p>The <code>translate_namedvalue()</code> method returns a dictionary formed from CSV entries in a ".value" file.</p>
<p>The <code>translate_template()</code> method returns a list of strings from a ".template" file (each modified by the data dictionary). Same as translate_list() just with a different file extension.</p>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../skill_structure/" class="btn btn-neutral float-left" title="Anatomy"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="../intents/" class="btn btn-neutral float-right" title="Intents">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
      <span><a href="../skill_structure/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../intents/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script src="../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "..";</script>
    <script src="../js/theme_extra.js"></script>
    <script src="../js/theme.js"></script>
      <script src="../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
